import{a1 as S,a2 as k,R as y,aa as F,_ as B,X as M,U as t,M as s,a9 as d,ax as U,Y as a,aw as c,a4 as A,a5 as C}from"./index-D0Rs-awC.js";import{c as N,a as p,u as R,d as f,V as q}from"./index.esm-DFnyy_Yl.js";import{v as P}from"./index-CSD3tc4i.js";import{b as V}from"./route-block-B_A1xBdJ.js";import{V as T,a as g}from"./VRow-BC4fDFmA.js";import{V as $}from"./VDivider-DFWSbqXd.js";import{V as D}from"./VContainer-CVNa3SM1.js";const X={class:"text-center"},Y={__name:"login",setup(j){const{api:x}=F(),i=S(),b=k(),v=y(),w=N({account:p().required("使用者帳號必填").min(4,"使用者帳號太短").max(20,"使用者帳號太長").test("isAlphanumeric","帳號格式不符",r=>P.isAlphanumeric(r)),password:p().required("使用者密碼必填").min(4,"使用者密碼太短").max(20,"使用者密碼太長")}),{handleSubmit:h,isSubmitting:m}=R({validationSchema:w}),n=f("account"),u=f("password"),_=h(async r=>{var e,o;try{const{data:l}=await x.post("/user/login",{account:r.account,password:r.password});v.login(l.result),i({text:"登入成功",snackbarProps:{color:"green"}}),b.push("/")}catch(l){console.log(l),i({text:((o=(e=l.response)==null?void 0:e.data)==null?void 0:o.message)||"未知錯誤",snackbarProps:{color:"red"}})}});return(r,e)=>(M(),B(D,{"max-width":"1600"},{default:t(()=>[s(T,null,{default:t(()=>[s(g,{cols:"12"},{default:t(()=>e[2]||(e[2]=[d("h1",{class:"text-center"},"登入",-1)])),_:1}),s($),s(g,{cols:"6",class:"mx-auto"},{default:t(()=>[s(q,{disabled:a(m),onSubmit:U(a(_),["prevent"])},{default:t(()=>[s(c,{modelValue:a(n).value.value,"onUpdate:modelValue":e[0]||(e[0]=o=>a(n).value.value=o),"error-messages":a(n).errorMessage.value,label:"帳號",minlength:"4",maxlength:"20",counter:""},null,8,["modelValue","error-messages"]),s(c,{modelValue:a(u).value.value,"onUpdate:modelValue":e[1]||(e[1]=o=>a(u).value.value=o),type:"password","error-messages":a(u).errorMessage.value,label:"密碼",minlength:"4",maxlength:"20",counter:""},null,8,["modelValue","error-messages"]),d("div",X,[s(A,{loading:a(m),type:"submit",color:"#495F41"},{default:t(()=>e[3]||(e[3]=[C("登入")])),_:1},8,["loading"])])]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1}))}};typeof V=="function"&&V(Y);export{Y as default};
