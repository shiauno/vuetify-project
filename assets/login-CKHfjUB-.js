import{a1 as S,aF as k,R as F,a9 as y,_ as B,X as M,U as t,M as s,a8 as d,aB as U,Y as a,au as c,a3 as A,a4 as C}from"./index-DCTA5BSV.js";import{c as N,a as p,u as R,d as f}from"./index.esm-DFDxVlUm.js";import{v as q}from"./index-DB8TQmCC.js";import{b as V}from"./route-block-B_A1xBdJ.js";import{V as P,a as g}from"./VRow-5eXdQqNh.js";import{V as T}from"./VDivider-Bz54YqAU.js";import{V as $}from"./VForm-CtHOijN8.js";import{V as D}from"./VContainer-DCYKGdi1.js";const X={class:"text-center"},Y={__name:"login",setup(j){const{api:x}=y(),i=S(),b=k(),v=F(),w=N({account:p().required("使用者帳號必填").min(4,"使用者帳號太短").max(20,"使用者帳號太長").test("isAlphanumeric","帳號格式不符",r=>q.isAlphanumeric(r)),password:p().required("使用者密碼必填").min(4,"使用者密碼太短").max(20,"使用者密碼太長")}),{handleSubmit:h,isSubmitting:m}=R({validationSchema:w}),n=f("account"),u=f("password"),_=h(async r=>{var e,o;try{const{data:l}=await x.post("/user/login",{account:r.account,password:r.password});v.login(l.result),i({text:"登入成功",snackbarProps:{color:"green"}}),b.push("/")}catch(l){console.log(l),i({text:((o=(e=l.response)==null?void 0:e.data)==null?void 0:o.message)||"未知錯誤",snackbarProps:{color:"red"}})}});return(r,e)=>(M(),B(D,{"max-width":"1600"},{default:t(()=>[s(P,null,{default:t(()=>[s(g,{cols:"12"},{default:t(()=>e[2]||(e[2]=[d("h1",{class:"text-center"},"登入",-1)])),_:1}),s(T),s(g,{cols:"6",class:"mx-auto"},{default:t(()=>[s($,{disabled:a(m),onSubmit:U(a(_),["prevent"])},{default:t(()=>[s(c,{modelValue:a(n).value.value,"onUpdate:modelValue":e[0]||(e[0]=o=>a(n).value.value=o),"error-messages":a(n).errorMessage.value,label:"帳號",minlength:"4",maxlength:"20",counter:""},null,8,["modelValue","error-messages"]),s(c,{modelValue:a(u).value.value,"onUpdate:modelValue":e[1]||(e[1]=o=>a(u).value.value=o),type:"password","error-messages":a(u).errorMessage.value,label:"密碼",minlength:"4",maxlength:"20",counter:""},null,8,["modelValue","error-messages"]),d("div",X,[s(A,{loading:a(m),type:"submit",color:"#495F41"},{default:t(()=>e[3]||(e[3]=[C("登入")])),_:1},8,["loading"])])]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1}))}};typeof V=="function"&&V(Y);export{Y as default};
